Hemorrhagic and ischemic DICOM images with stroke findings and their corresponding masks were collected in two separate folders. The DICOM images were resized to 256Ã—256 pixels to ensure compatibility with the dimensions of the masks used for training the model outputs. The masks were read as single-channel grayscale images and resized accordingly. Separate arrays were created for the images and masks. The resulting dataset was split into 80% training and 20% testing subsets.

The model was developed using a U-Net architecture based on Keras and TensorFlow frameworks. The input size was set to (256, 256, 1), and the model was designed with encoder and decoder layers. The encoder consisted of convolutional layers with filter sizes of 64, 128, 256, and 512, followed by MaxPooling layers. The bottleneck layer applied convolution with 512 filters. In the decoder, dimensions were increased using UpSampling layers, which were concatenated with corresponding encoder layers and followed by convolutional operations.

Two classes were defined in the masks to represent the background and stroke types by pixel values. The model was trained using a combined loss function of binary cross-entropy and Dice Loss. Masks could be converted to categorical values using the keras.utils.to_categorical method when necessary. Pixel values of the images, originally ranging from 0 to 255, were rescaled to the range [0, 1].

The Adam optimizer was used for model optimization. Model performance was evaluated using loss, Dice Coefficient, and F1 Score metrics. The model outputs were single-channel masks generated by a sigmoid activation function, converted to appropriate pixel values.

During training, callbacks including ModelCheckpoint, CSVLogger, ReduceLROnPlateau, EarlyStopping, and a custom F1ScoreCallback function were employed. The F1 score was calculated at the end of each epoch to better assess model performance. Training was conducted with a batch size of 8 over 20 epochs. The best model weights were saved during training to achieve higher accuracy.

